{% extends 'base.html' %}
{% block content %}
{% comment %} <meta http-equiv="refresh" content="10"/> {% endcomment %}
    <h2>Silent auction page</h2>
    {% if user.is_superuser and not published%}
    <h3>Create New Item</h3>
    <form action="{% url "create_item" %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <table>
            {{createItemForm.as_table}}
        </table>
        <input type="hidden" name="type" value="silent"></input>
        <button type="submit">Submit</button>
    </form>
    {% endif %}
    <h3>Winning</h3>
    {% if winning %}
        {% for bid, item, form in winning %}
            <div style="width: 20%; height: 25%; border: solid 10px black; padding: 20px; display: inline-block; border-radius: 20px; -moz-border-radius: 10px; background-color: darkgrey; text-align: left;">
            <h2>Title: {{ item.title }}</h2>
            {{item.image}}
            {{item.image.url}}
            <img src="{{ item.image.url }}" style="width:100%; height:100%;"></img>
            <p>Description: {{ item.description }}</p>
            <p>Current Bid: {{ bid }}</p>
            {% if published %}
            <form action="{% url 'submit_bid' %}" method="post">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="hidden" name="item_id" value="{{ item.id }}" />
                <button type="submit">Bid</button>
            </form>
            {% elif not published and user.is_superuser%}
                <form action="delete_item" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="type" value="silent">
                    <input type="hidden" name="pk" value="{{ item.pk }}">
                    <button type="submit">Delete</button>
                </form>
            {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <strong>No items match the criteria</strong>
    {% endif %}
    <h3>Bid On</h3>
    {% if winning %}
        {% for bid, item, form in bidon %}
            <div style="width: 20%; height: 25%; border: solid 10px black; padding: 20px; display: inline-block; border-radius: 20px; -moz-border-radius: 10px; background-color: darkgrey; text-align: left;">
            <h2>Title: {{ item.title }}</h2>
            <img src="{{ item.image.url }}" style="width:100%; height:100%;"></img>
            <p>Description: {{ item.description }}</p>
            <p>Current Bid: {{ bid }}</p>
            {% if published %}
            <form action="{% url 'submit_bid' %}" method="post">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="hidden" name="item_id" value="{{ item.id }}" />
                <button type="submit">Bid</button>
            </form>
            {% elif not published and user.is_superuser%}
                <form action="delete_item" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="type" value="silent">
                    <input type="hidden" name="pk" value="{{ item.pk }}">
                    <button type="submit">Delete</button>
                </form>
            {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <strong>No items match the criteria</strong>
    {% endif %}
    <h3>Unbid</h3>
    {% if unbid %}
        {% for bid, item, form in unbid %}
            <div style="width: 20%; height: 25%; border: solid 10px black; padding: 20px; display: inline-block; border-radius: 20px; -moz-border-radius: 10px; background-color: darkgrey; text-align: left;">
            <h2>Title: {{ item.title }}</h2>
            <img src="{{ item.image.url }}" style="width:100%; height:100%;"></img>
            <p>Description: {{ item.description }}</p>
            <p>Current Bid: {{ bid }}</p>
            {% if published %}
            <form action="{% url 'submit_bid' %}" method="post">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="hidden" name="item_id" value="{{ item.id }}" />
                <button type="submit">Bid</button>
            </form>
            {% elif not published and user.is_superuser%}
                <form action="delete_item" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="type" value="silent">
                    <input type="hidden" name="pk" value="{{ item.pk }}">
                    <button type="submit">Delete</button>
                </form>
            {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <strong>No items match the criteria</strong>
    {% endif %}

{% endblock %}